// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

var Caml_oo_curry          = require("bs-platform/lib/js/caml_oo_curry.js");
var Dom$Sweenyville        = require("./dom.bs.js");
var Pixi$Sweenyville       = require("./pixi.bs.js");
var Character$Sweenyville  = require("./character.bs.js");
var Controller$Sweenyville = require("./controller.bs.js");

function start() {
  var app = Pixi$Sweenyville.App[/* start */0](/* () */0);
  var callback = function (_, resources) {
    var myHero = Pixi$Sweenyville.App[/* loadHero */2](resources);
    Pixi$Sweenyville.Sprite[/* rescale */0](myHero, 0.2, 0.2);
    var r = Pixi$Sweenyville.App[/* renderer */4](app);
    var player = Character$Sweenyville.character(Pixi$Sweenyville.App[/* width */5](r) / 2 | 0, Pixi$Sweenyville.App[/* height */6](r) / 2 | 0);
    Pixi$Sweenyville.Sprite[/* position */1](myHero, Caml_oo_curry.js2(-1033677270, 2, player, /* () */0)[/* x */0], Caml_oo_curry.js2(-1033677270, 1, player, /* () */0)[/* y */1]);
    Pixi$Sweenyville.App[/* addSprite */7](app, myHero);
    var controller = Controller$Sweenyville.controller(player);
    Dom$Sweenyville.listen("keydown", (function ($$event) {
            var d = Dom$Sweenyville.keyMap($$event);
            Caml_oo_curry.js2(-933174511, 3, controller, d);
            if (d) {
              var match = d[0];
              if (match !== 2) {
                if (match >= 3) {
                  return Pixi$Sweenyville.Sprite[/* rescale */0](myHero, 0.2, 0.2);
                } else {
                  return /* () */0;
                }
              } else {
                return Pixi$Sweenyville.Sprite[/* rescale */0](myHero, -0.2, 0.2);
              }
            } else {
              return /* () */0;
            }
          }));
    Dom$Sweenyville.listen("keyup", (function ($$event) {
            var d = Dom$Sweenyville.keyMap($$event);
            return Caml_oo_curry.js2(-866390014, 4, controller, d);
          }));
    return Pixi$Sweenyville.App[/* addTicker */3](app, (function () {
                  Caml_oo_curry.js2(-855850147, 5, controller, /* () */0);
                  return Pixi$Sweenyville.Sprite[/* position */1](myHero, Caml_oo_curry.js2(-1033677270, 7, player, /* () */0)[/* x */0], Caml_oo_curry.js2(-1033677270, 6, player, /* () */0)[/* y */1]);
                }));
  };
  Pixi$Sweenyville.App[/* loadTexture */1]("hero", "images/hero/Idle (1).png", callback);
  return app;
}

exports.start = start;
/* Pixi-Sweenyville Not a pure module */
